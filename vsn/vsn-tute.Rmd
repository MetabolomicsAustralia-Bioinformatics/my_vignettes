---
title: "R Notebook"
output: html_notebook
---

```{r}
suppressMessages(library("vsn"))
suppressMessages(library("ggplot2"))
suppressMessages(library("tidyverse"))
data("kidney")
```

## Trying out with LC Data

Running section 2 from the [official `vsn` tutorial](https://bioconductor.org/packages/release/bioc/vignettes/vsn/inst/doc/A-vsn.html#assessing-the-performance-of-vsn). 

```{r}
tbl0 <- read_csv("/Users/don/Documents/my_vignettes/data/test_dme_data.csv") %>% replace(is.na(.), 0)
```
```{r}
# Make `ExpressionSet` object
m <- as.matrix(tbl0 %>% dplyr::select(-c("Sample", "Group")))
rownames(m) <- as.vector(unlist(tbl0$Sample))
my_data <- object<-new("ExpressionSet", exprs=t(m))
```

mean and sd of each metabolite are indeed positively correlated:

```{r}
# meanSdPlot() un-normalized data
meanSdPlot(my_data, rank=TRUE)
```

Now to normalize and inspect with meanSdPlot again:

```{r}
# Normalize and meanSdPlot() data
xnorm <- justvsn(my_data)
meanSdPlot(xnorm, rank=TRUE)
```
```{r}
head(exprs(xnorm))
```

